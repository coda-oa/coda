{% extends "base.html" %}
{% block content %}
    <h1>Funding Request</h1>
    <p>
        <b>Status: {{ funding_request.get_processing_status_display }}</b>
    </p>
    <div class="flex justify-between my-2">
        <div>
            <span class="mr-2">Labels:</span>
            {% for label in funding_request.labels.all %}
                <span style="background-color: {{ label.hexcolor }};" class="pill">{{ label }}</span>
            {% endfor %}
        </div>
        <div class="flex">
            <form action="{% url "fundingrequests:label_attach" %}" method="post">
                {% csrf_token %}
                <fieldset role="group">
                    <input type="hidden" name="fundingrequest" value="{{ funding_request.pk }}">
                    {{ label_form }}
                    <button type="submit">Attach</button>
                </fieldset>
            </form>
            <a href="{% url "fundingrequests:label_create" next=funding_request.pk %}"
               class="secondary"
               role="button">Create new</a>
        </div>
    </div>
    <div>
        <table>
            <tbody>
                <tr>
                    <td>Request ID</td>
                    <td>{{ funding_request.request_id }}</td>
                </tr>
                <tr>
                    <td>Request Submitter</td>
                    <td>
                        <p>{{ funding_request.submitter.name }}</p>
                        <p>{{ funding_request.submitter.affiliation.name }}</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>Publication Details</h2>
        <table>
            <tbody>
                <tr>
                    <td>Title</td>
                    <td>{{ funding_request.publication.title }}</td>
                </tr>
                <tr>
                    <td>Journal</td>
                    <td>{{ funding_request.publication.journal.title }}</td>
                </tr>
                <tr>
                    <td>Author</td>
                    <td>{{ funding_request.publication.author.name }}</td>
                </tr>
                <tr>
                    <td>Estimated Cost</td>
                    <td>{{ funding_request.estimated_cost }} {{ funding_request.estimated_cost_currency }}</td>
                </tr>
            </tbody>
        </table>
        {% if funding_request.publication.links %}
            <h3>References</h3>
            <table>
                <thead>
                    <tr>
                        <th>Link Type</th>
                        <th>Link</th>
                    </tr>
                </thead>
                <tbody>
                    {% for link in funding_request.publication.links.all %}
                        <tr>
                            <td>{{ link.type }}</td>
                            <td>
                                <a href="{{ link.value }}">{{ link.value }}</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
{% endblock content %}
